+ JOB_NAME=compute-rocm-rel-5.3
+ JOB_NUM=96
+ ART_SERVER=compute-artifactory.amd.com
+ ART_URL=http://compute-artifactory.amd.com/artifactory/list/compute-pytorch-rocm/compute-rocm-rel-5.3/96/
+ TORCH_WHL_VER=1.12.1
+ VISION_WHL_VER=0.13.1
+ PY_VER=3.8
+ sudo docker run --rm -v /home/jenkins/.bb/test:/root/whl --shm-size 8G --cap-add=SYS_PTRACE --privileged --security-opt seccomp=unconfined --network=host --device=/dev/kfd --device=/dev/dri --group-add video compute-artifactory.amd.com:5000/rocm-plus-docker/framework/release-public:ub20-py3.8-test bash -xc 'apt update && pip3 install --upgrade pip && 	pip3 install --verbose --use-deprecated=legacy-resolver torch==1.12.1 torchvision==0.13.1 -f http://compute-artifactory.amd.com/artifactory/list/compute-pytorch-rocm/compute-rocm-rel-5.3/96/ --trusted-host compute-artifactory.amd.com && 	cd /root/whl/pytorch-micro-benchmarking && python3 micro_benchmarking_pytorch.py --network resnet50'
Unable to find image 'compute-artifactory.amd.com:5000/rocm-plus-docker/framework/release-public:ub20-py3.8-test' locally
ub20-py3.8-test: Pulling from rocm-plus-docker/framework/release-public
e0b25ef51634: Already exists
a6ef24ac8f95: Pulling fs layer
6e7921809d71: Pulling fs layer
d13a71bc3480: Pulling fs layer
d13a71bc3480: Download complete
6e7921809d71: Verifying Checksum
6e7921809d71: Download complete
a6ef24ac8f95: Verifying Checksum
a6ef24ac8f95: Download complete
a6ef24ac8f95: Pull complete
6e7921809d71: Pull complete
d13a71bc3480: Pull complete
Digest: sha256:a812fad86bdf896ef127408d1bc0b55767954024cebb704ca025d2d7f73eb408
Status: Downloaded newer image for compute-artifactory.amd.com:5000/rocm-plus-docker/framework/release-public:ub20-py3.8-test
+ apt update

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Hit:1 http://archive.ubuntu.com/ubuntu focal InRelease
Get:2 http://archive.ubuntu.com/ubuntu focal-updates InRelease [114 kB]
Get:3 http://security.ubuntu.com/ubuntu focal-security InRelease [114 kB]
Get:4 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal InRelease [18.1 kB]
Get:5 http://archive.ubuntu.com/ubuntu focal-backports InRelease [108 kB]
Get:6 http://archive.ubuntu.com/ubuntu focal-updates/universe amd64 Packages [1224 kB]
Get:7 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu focal/main amd64 Packages [29.4 kB]
Get:8 http://security.ubuntu.com/ubuntu focal-security/main amd64 Packages [2267 kB]
Get:9 http://archive.ubuntu.com/ubuntu focal-updates/multiverse amd64 Packages [37.7 kB]
Get:10 http://archive.ubuntu.com/ubuntu focal-updates/main amd64 Packages [2737 kB]
Get:11 http://archive.ubuntu.com/ubuntu focal-updates/restricted amd64 Packages [1772 kB]
Get:12 http://archive.ubuntu.com/ubuntu focal-backports/universe amd64 Packages [27.5 kB]
Get:13 http://archive.ubuntu.com/ubuntu focal-backports/main amd64 Packages [55.2 kB]
Get:14 http://security.ubuntu.com/ubuntu focal-security/universe amd64 Packages [926 kB]
Get:15 http://security.ubuntu.com/ubuntu focal-security/restricted amd64 Packages [1655 kB]
Fetched 11.1 MB in 9s (1278 kB/s)
Reading package lists...
Building dependency tree...
Reading state information...
50 packages can be upgraded. Run 'apt list --upgradable' to see them.
+ pip3 install --upgrade pip
Requirement already satisfied: pip in /usr/local/lib/python3.8/dist-packages (22.2.2)
Collecting pip
  Downloading pip-22.3-py3-none-any.whl (2.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 4.4 MB/s eta 0:00:00
Installing collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 22.2.2
    Uninstalling pip-22.2.2:
      Successfully uninstalled pip-22.2.2
Successfully installed pip-22.3
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
+ pip3 install --verbose --use-deprecated=legacy-resolver torch==1.12.1 torchvision==0.13.1 -f http://compute-artifactory.amd.com/artifactory/list/compute-pytorch-rocm/compute-rocm-rel-5.3/96/ --trusted-host compute-artifactory.amd.com
Using pip 22.3 from /usr/local/lib/python3.8/dist-packages/pip (python 3.8)
Looking in links: http://compute-artifactory.amd.com/artifactory/list/compute-pytorch-rocm/compute-rocm-rel-5.3/96/
Collecting torch==1.12.1
  Downloading http://compute-artifactory.amd.com/artifactory/list/compute-pytorch-rocm/compute-rocm-rel-5.3/96/torch-1.12.1%2Brocm5.3.2-cp38-cp38-linux_x86_64.whl (1523.5 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.5/1.5 GB 604.9 kB/s eta 0:00:00
Collecting torchvision==0.13.1
  Downloading http://compute-artifactory.amd.com/artifactory/list/compute-pytorch-rocm/compute-rocm-rel-5.3/96/torchvision-0.13.1%2Brocm5.3.2-cp38-cp38-linux_x86_64.whl (76.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 76.3/76.3 MB 5.7 MB/s eta 0:00:00
Collecting typing-extensions
  Downloading typing_extensions-4.4.0-py3-none-any.whl (26 kB)
Requirement already satisfied: requests in /usr/lib/python3/dist-packages (from torchvision==0.13.1) (2.22.0)
Collecting numpy
  Downloading numpy-1.23.4-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 17.1/17.1 MB 5.9 MB/s eta 0:00:00
Collecting pillow!=8.3.*,>=5.3.0
  Downloading Pillow-9.3.0-cp38-cp38-manylinux_2_28_x86_64.whl (3.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 3.3/3.3 MB 2.6 MB/s eta 0:00:00
Installing collected packages: typing-extensions, torch, numpy, pillow, torchvision
  changing mode of /usr/local/bin/convert-caffe2-to-onnx to 755
  changing mode of /usr/local/bin/convert-onnx-to-caffe2 to 755
  changing mode of /usr/local/bin/torchrun to 755
  changing mode of /usr/local/bin/f2py to 755
  changing mode of /usr/local/bin/f2py3 to 755
  changing mode of /usr/local/bin/f2py3.8 to 755
Successfully installed numpy-1.23.4 pillow-9.3.0 torch-1.12.1+rocm5.3.2 torchvision-0.13.1+rocm5.3.2 typing-extensions-4.4.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
+ cd /root/whl/pytorch-micro-benchmarking
+ python3 micro_benchmarking_pytorch.py --network resnet50
MIOpen(HIP): Warning [SQLiteBase] Missing system database file: gfx906_60.kdb Performance may degrade. Please follow instructions to install: https://github.com/ROCmSoftwarePlatform/MIOpen#installing-miopen-kernels-package
INFO: running forward and backward for warmup.
INFO: running the benchmark..
OK: finished running benchmark..
--------------------SUMMARY--------------------------
Microbenchmark for network : resnet50
Num devices: 1
Dtype: FP32
Mini batch size [img] : 64
Time per mini-batch : 0.2342471480369568
Throughput [img/sec] : 273.21570630137546
+ echo rtn=0
rtn=0
